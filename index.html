<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Code Maastricht</title>

  <!-- Thema voor browser en PWA -->
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Code Maastricht" />

  <!-- App iconen -->
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="/icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="/icon-512.png" />
  <link rel="shortcut icon" href="/icon-192.png" type="image/png" />

  <!-- OneSignal SDK -->
 <!-- OneSignal SDK -->
<script defer src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js"></script> 
<script>
  // Zorg ervoor dat de array OneSignalDeferred goed is ge√Ønitialiseerd
  window.OneSignalDeferred = window.OneSignalDeferred || [];

  // Voeg de functie toe aan de wachtrij van OneSignalDeferred
  OneSignalDeferred.push(async function(OneSignal) {
    try {
      const urlParams = new URLSearchParams(location.search);
      const view = urlParams.get("view");
      const team = urlParams.get("team");
      const tag = view === "edit123" ? "beheer" : team;

      // Initialiseer OneSignal
      await OneSignal.init({
        appId: "0c55e75a-a7cc-4829-8359-3171d4f456d0",
        language: "nl",
        notifyButton: {
          enable: false // ‚õîÔ∏è belletje uitgezet
        },
        promptOptions: {
          slidedown: {
            enabled: true,
            autoPrompt: true // ‚úÖ automatische prompt weer aan
          }
        }
      });

      // Voeg de tag toe als deze bestaat
      if (tag) {
        await OneSignal.User.addTags({ team: tag });
        console.log("‚úÖ Tag ingesteld:", tag);
      }

      // Verkrijg de permissiestatus voor meldingen
      const status = await OneSignal.Notifications.permission;
      console.log("üîî Permissiestatus:", status);
    } catch (err) {
      console.error("‚ùå Fout bij OneSignal initialisatie:", err);
    }
  });
</script>
  
  <!-- Firebase (Realtime Database) behouden -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
</head>

  <style>
  body {
    font-family: Arial, sans-serif;
    background-color: #000;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    margin: 0;
    padding: 1em;
    box-sizing: border-box;
    text-align: center;
  }

  #teamLabel {
    font-size: 1.5em;
    margin: 0.3em 0 1em;
    color: orange;
    display: none;
  }

  #timer {
    font-size: clamp(3em, 10vw, 6em);
    padding: 0.5em 1em;
    background: #111;
    border: 5px solid white;
    border-radius: 20px;
    text-align: center;
    margin-bottom: 1em;
    width: 80%;
    max-width: 500px;
  }

  .controls {
    margin-top: 1.5em;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
  }

  input[type="text"], select {
    padding: 0.5em;
    font-size: 1em;
    width: 100%;
    max-width: 300px;
    margin: 8px 0;
    box-sizing: border-box;
  }

  #timeSlider {
    width: 100%;
    max-width: 500px;
    margin-top: 1em;
  }

  .flash {
    animation: flash 1s infinite;
  }

  @keyframes flash {
    0%, 100% { background: #111; color: white; }
    50% { background: red; color: black; }
  }

  .urgent {
    animation: urgentFlash 1s infinite;
  }

  @keyframes urgentFlash {
    0%, 100% { background: #111; color: white; }
    50% { background: darkred; color: yellow; transform: scale(1.05); }
  }

.footer {
  bottom: 1em;
  right: 1em;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 0.3em;
  color: gray;
  font-size: 1.0em;
  text-align: right;
  z-index: 9999;
}

  #scoreBoard {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1em;
    margin: 2em 0;
    width: 100%;
    max-width: 600px;
  }

  .scorecard {
    flex: 1 1 200px;
    max-width: 240px;
    background: #111;
    color: white;
    border: 5px solid white;
    border-radius: 20px;
    font-size: 2em;
    padding: 1em;
    cursor: pointer;
    text-align: center;
  }

  .scorecard .scoreName {
    font-size: 0.7em;
    color: orange;
    display: block;
    margin-bottom: 0.3em;
  }

  .scorecard.selected {
    border-color: orange;
  }

  #scoreControls {
    display: flex;
    justify-content: center;
    gap: 1em;
    flex-wrap: wrap;
    margin-top: 1em;
    width: 100%;
    max-width: 300px;
  }

  #scoreControls .score-btn {
    background: #222;
    color: white;
    border: 2px solid white;
    border-radius: 10px;
    padding: 0.5em;
    font-size: 1em;
    cursor: pointer;
    flex: 1 1 auto;
  }

#teamUploadIframeSection iframe {
  width: 100%;
  height: 530px; /* iets kleiner zodat de Jotform-footer net afvalt */
  min-height: 400px;
  overflow: hidden;
  border: none;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(255,255,255,0.2);
  margin-bottom: 0;
  padding-bottom: 0;
}

 #refreshBtn {
  font-size: 1em;
  padding: 0.5em 1em;
  background-color: transparent;
  color: white;
  border: 2px solid white;
  border-radius: 5px;
  cursor: pointer;
  width: 100px; /* pas dit aan om de knop kleiner te maken */
  margin-top: 1em;
  text-align: center;
}

#refreshWarning {
  font-size: 0.9em;
  color: orange;
  margin-top: 10px;
  display: none; /* Standaard niet zichtbaar */
  text-align: center;
}

#refreshBtnWrapper:hover #refreshWarning {
  display: block; /* Maak de waarschuwing zichtbaar bij hover */
}

@media (max-width: 767px) {
  #timer {
    font-size: clamp(2.2em, 8vw, 4em);
    padding: 0.3em 0.5em;
    margin-bottom: 0.5em;
  }
}

@media (max-width: 600px) {
  #teamUploadIframeSection iframe {
    height: 550px; /* iets ruimer als nodig */
    margin-bottom: 0;
  }
}

    .controls, .tekst-controls {
      max-width: 300px;
      width: 100%;
    }

    button, input[type="text"], select {
      font-size: 0.9em;
      padding: 0.5em;
      margin: 4px 0;
      max-width: 95%;
    }

    #timeSlider {
      margin-top: 0.5em;
      height: 20px;
    }

    .scorecard {
      flex: 1 1 45%;
      max-width: 25%;
    }
</style>
</head>
<body>
<script>
  const CLIENT_TOKEN = "geheimvoorclient"; // ‚úÖ Alleen gebruiken voor communicatie met eigen server
  window.addEventListener("DOMContentLoaded", () => {
  const urlParams = new URLSearchParams(window.location.search);
  const view = urlParams.get("view");
  const team = urlParams.get("team");

  const isDisplayMode = view === "display" && team && ["37xskp", "z8kd01"].includes(team);
  const isControlMode = view === "edit123";

  const pushMijlpalen = [7200, 5400, 3600, 1800, 600, 0];
  let laatstVerzondenMijlpaal = null;

  const teamCode = team;
  const allowedTeams = { "37xskp": "Team A", "z8kd01": "Team B" };

  const firebaseConfig = {
    apiKey: "AIzaSyA9PTsrTBR7cYf1oAfPtnyF4g9laqkdwng",
    authDomain: "puzzeltocht-maastricht.firebaseapp.com",
    databaseURL: "https://puzzeltocht-maastricht-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "puzzeltocht-maastricht",
    storageBucket: "puzzeltocht-maastricht.appspot.com",
    messagingSenderId: "825884044147",
    appId: "1:825884044147:web:f329c4af2373cbedbcb306"
  };

  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  
  const db = firebase.database();
  const timerRef = db.ref("timer");
  const tekstRef = db.ref("tekst");
  const teamnamenRef = db.ref("teamnamen");
  const scoresRef = db.ref("scores");

  if (isDisplayMode) {
    const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    const isStandalone = window.navigator.standalone === true;

    if (isIos && !isStandalone) {
      const installTip = document.createElement("div");
      installTip.innerHTML = `
        üì≤ <strong>Tip voor iPhone-gebruikers</strong><br/>
        Voeg deze pagina toe aan je beginscherm om meldingen te ontvangen.<br/><br/>
        Tik op <span style="font-size: 1.3em;">üîó</span> onderaan en kies <em>‚ÄòZet op beginscherm‚Äô</em>.
      `;
      installTip.style = `
        background: #220;
        color: orange;
        padding: 1em;
        margin: 1em auto;
        border: 1px solid orange;
        border-radius: 10px;
        text-align: center;
        max-width: 500px;
      `;
      document.body.prepend(installTip);
    }
  }

  const teamLabel = document.getElementById("teamLabel");
  if (isDisplayMode && teamCode && teamLabel) {
    teamnamenRef.child(teamCode).on("value", (snap) => {
      teamLabel.textContent = snap.val() || "Team onbekend";
      teamLabel.style.display = "block";
    });
  }

  if (isControlMode) {
    const inputA = document.getElementById("inputTeamA");
    const inputB = document.getElementById("inputTeamB");
    const knop = document.getElementById("opslaanTeamnamen");

    if (inputA && inputB && knop) {
      knop.addEventListener("click", () => {
        teamnamenRef.set({ "37xskp": inputA.value.trim(), "z8kd01": inputB.value.trim() });
      });
      teamnamenRef.once("value", (snap) => {
        const data = snap.val() || {};
        inputA.value = data["37xskp"] || "";
        inputB.value = data["z8kd01"] || "";
      });
    }
  }

if (isDisplayMode) {
  // Opdrachten genereren
  const opdrachten = Array.from({ length: 25 }, (_, i) => `Opdracht ${i + 1}`);

  // Hint aanvragen sectie maken
const hintDiv = document.createElement("div");
hintDiv.style = "margin: 2em 0; text-align: center; position: relative;";
hintDiv.innerHTML = `
  <h3>üîç Hint aanvragen</h3>
  <p style="font-size: 0.95em; color: #ff4444; font-weight: bold; margin: 0.5em 0;">
    Let op! Een hint aanvragen kost 1 punt.
  </p>
  <select id="opdrachtSelect" style="font-size: 1em; padding: 0.5em; background-color: #111; color: white; border-radius: 5px; border: 1px solid #fff;">
    <option value="">-- Kies een opdracht --</option>
    ${opdrachten.map((opdracht, i) => `<option value="${i + 1}">${opdracht}</option>`).join("")}
  </select><br/>
  <button id="vraagHintKnop" style="margin-top: 0.5em; padding: 0.5em 1em; background-color: #ff4444; color: white; border: none; border-radius: 5px; cursor: pointer;">
    Vraag hint aan
  </button>
`;

// Voeg de hintDiv toe aan de pagina
const uploadSection = document.getElementById("teamUploadIframeSection");
if (uploadSection) {
  uploadSection.parentNode.insertBefore(hintDiv, uploadSection);
} else {
  document.body.appendChild(hintDiv);
}

// Event handler voor het aanvragen van een hint
const vraagHintKnop = document.getElementById("vraagHintKnop");
vraagHintKnop?.addEventListener("click", async () => {
  const opdracht = document.getElementById("opdrachtSelect")?.value;
  if (!opdracht) {
    alert("‚ùå Kies een opdracht eerst.");
    return;
  }

  // Controleer of CLIENT_TOKEN beschikbaar is
  if (!CLIENT_TOKEN) {
    alert("‚ùå Geen toegangstoken gevonden. Probeer de pagina opnieuw te laden.");
    console.error("CLIENT_TOKEN ontbreekt of is ongeldig:", CLIENT_TOKEN);
    return;
  }

  // Payload opbouwen voor het verzoek
  const payload = {
    title: "Hint aangevraagd",
    message: `Team ${team} vraagt een hint aan voor opdracht ${opdracht}`,
    doelgroepen: ["beheer", `team_${team}`], // Tags voor de doelgroep
    type: "hint"
  };

  console.log("üì§ Hintverzoek starten voor opdracht:", opdracht);
  console.log("üß© Team:", team);
  console.log("üöÄ Payload:", payload);

  try {
    // Verzoek versturen naar de pushserver
    const response = await fetch("https://puzzeltochtmaastricht-pushserver-maastricht.fly.dev/push", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Basic ${CLIENT_TOKEN}`
      },
      body: JSON.stringify(payload)
    });

    const result = await response.json();
    console.log("üì¨ Reactie van pushserver:", result);

    if (!response.ok) {
      console.error("‚ùå Serverfout:", result);
      alert(`‚ùå Hintverzoek mislukt (${response.status}). Foutmelding: ${result?.error || "onbekend"}`);
      return;
    }

    // Bevestiging bij succes
    alert("‚úÖ Hintverzoek succesvol verstuurd!");
  } catch (err) {
    console.error("‚ùå Netwerkfout of fetch-mislukking:", err);
    alert("‚ùå Hintverzoek kon niet verzonden worden. Controleer je internetverbinding of probeer opnieuw.");
  }
});

// === TIMER ===
  const timerDisplay = document.getElementById("timer");
  const slider = document.getElementById("timeSlider");
  const startBtn = document.getElementById("startBtn");
  const stopBtn = document.getElementById("stopBtn");
  const resetBtn = document.getElementById("resetBtn");
  const manualInput = document.getElementById("manualTimeInput");

  let totalSeconds = 9000;
  let remaining = totalSeconds;
  let interval = null;
  let previousRemaining = null;
  let flashTimeout = null;
  let isSliding = false;

  function formatTime(secs) {
    const h = String(Math.floor(secs / 3600)).padStart(2, '0');
    const m = String(Math.floor((secs % 3600) / 60)).padStart(2, '0');
    const s = String(secs % 60).padStart(2, '0');
    return `${h}:${m}:${s}`;
  }

  function updateDisplay() {
    if (timerDisplay && slider) {
      timerDisplay.textContent = remaining > 0 ? formatTime(remaining) : "TIJD OM!";
      slider.value = remaining;

      // Reset visuele effecten
      timerDisplay.classList.remove("flash", "urgent");
      timerDisplay.style.borderColor = "white";
      timerDisplay.style.backgroundColor = "#111";
      timerDisplay.style.color = "white";
      timerDisplay.style.transform = "scale(1)";

      // Mijlpaalkleuren
      if ([7200, 5400, 3600, 1800].includes(remaining)) {
        timerDisplay.classList.add("flash");
        setTimeout(() => timerDisplay.classList.remove("flash"), 10000);
      }

      // Laatste 10 minuten
      if (remaining > 0 && remaining <= 600) {
        const urgencyLevel = 10 - Math.floor(remaining / 60);
        const scale = 1 + urgencyLevel * 0.03;
        const color = `rgb(${100 + urgencyLevel * 15}, 0, 0)`;
        const bgColor = `rgb(${30 + urgencyLevel * 20}, 0, 0)`;
        timerDisplay.classList.add("urgent");
        timerDisplay.style.transform = `scale(${scale})`;
        timerDisplay.style.color = "yellow";
        timerDisplay.style.backgroundColor = bgColor;
        timerDisplay.style.borderColor = color;
      }
    }
  }

  function updateFirebase(running) {
    const data = {
      remaining,
      running
    };
    if (running) {
      data.timestamp = Date.now();
    }
    timerRef.set(data);
  }

  function calcRemaining(rem, timestamp) {
    const passed = Math.floor((Date.now() - timestamp) / 1000);
    return Math.max(0, rem - passed);
  }

  timerRef.on("value", (snapshot) => {
    const data = snapshot.val();
    if (!data) return;

    const wasRunning = !!interval;
    const origineleRemaining = data.remaining ?? 9000;
    const startTimestamp = data.timestamp ?? Date.now();

    remaining = data.running
      ? calcRemaining(origineleRemaining, startTimestamp)
      : origineleRemaining;

    updateDisplay();
    if (data.running && remaining > 0) {
      if (interval) clearInterval(interval);
      interval = setInterval(() => {
        if (!isSliding) {
          remaining = calcRemaining(origineleRemaining, startTimestamp);

          const mijlpalen = [7200, 5400, 3600, 1800];
          if (mijlpalen.includes(remaining) && remaining !== previousRemaining) {
            timerDisplay.classList.add("flash");
            if (flashTimeout) clearTimeout(flashTimeout);
            flashTimeout = setTimeout(() => {
              timerDisplay.classList.remove("flash");
              flashTimeout = null;
            }, 10000);
          }

          if (remaining > 0 && remaining <= 600) {
            const urgencyLevel = 10 - Math.floor(remaining / 60);
            const scale = 1 + urgencyLevel * 0.03;
            const color = `rgb(${100 + urgencyLevel * 15}, 0, 0)`;
            const bgColor = `rgb(${30 + urgencyLevel * 20}, 0, 0)`;
            timerDisplay.classList.add("urgent");
            timerDisplay.style.transform = `scale(${scale})`;
            timerDisplay.style.color = "yellow";
            timerDisplay.style.backgroundColor = bgColor;
            timerDisplay.style.borderColor = color;
          } else {
            timerDisplay.classList.remove("urgent");
            timerDisplay.style.transform = "scale(1)";
            timerDisplay.style.color = "white";
            timerDisplay.style.backgroundColor = "#111";
            timerDisplay.style.borderColor = "white";
          }

          previousRemaining = remaining;
          updateDisplay();
        }
      }, 1000);
    }

    if (!data.running && wasRunning) {
      clearInterval(interval);
      interval = null;
    }
  });

startBtn?.addEventListener("click", () => {
  if (remaining > 0) {
    updateFirebase(true); // Timer starten in Firebase

    // Start de timer zonder verdere meldingen
    interval = setInterval(() => {
      if (!isSliding) {
        remaining -= 1; // Verlaag de resterende tijd
        updateDisplay();
        updateFirebase(true); // Verzend de tijd naar Firebase
      }

      if (remaining <= 0) {
        clearInterval(interval);
        interval = null;
        updateFirebase(false); // Stop de timer in Firebase
      }
    }, 1000); // Elke seconde bijwerken
  }
});

  stopBtn?.addEventListener("click", () => {
    clearInterval(interval);
    interval = null;
    updateFirebase(false);
  });

  resetBtn?.addEventListener("click", () => {
    clearInterval(interval);
    interval = null;

    remaining = totalSeconds;
    updateDisplay();
    timerRef.set({ remaining: totalSeconds, running: false });
    scoresRef.set({ "37xskp": 0, "z8kd01": 0 });
    teamnamenRef.set({ "37xskp": allowedTeams["37xskp"], "z8kd01": allowedTeams["z8kd01"] });
  });

  slider?.addEventListener("input", () => {
    isSliding = true;
    remaining = parseInt(slider.value);
    updateDisplay();
  });

  slider?.addEventListener("change", () => {
    isSliding = false;
    updateFirebase(!!interval);
  });

  window.stelHandmatigTijdIn = () => {
    if (!manualInput) return;
    const parts = manualInput.value.trim().split(":").map(Number);
    if (parts.length !== 3 || parts.some(isNaN)) {
      alert("Gebruik het formaat hh:mm:ss");
      return;
    }
    const [h, m, s] = parts;
    const nieuweTijd = h * 3600 + m * 60 + s;
    if (nieuweTijd > 9000) {
      alert("Maximale tijd is 2:30:00 (9000 sec)");
      return;
    }
    remaining = nieuweTijd;
    updateDisplay();
    updateFirebase(!!interval);
  };

  // === BEDIENING TEKSTEN VIA KNOPPEN ===
  const tekstSelect = document.getElementById("tekstSelect");
  const toonTekstKnop = document.getElementById("toonTekstKnop");
  const eigenTekstKnop = document.getElementById("eigenTekstKnop");
  const verbergTekstKnop = document.getElementById("verbergTekstKnop");

  toonTekstKnop?.addEventListener("click", () => {
    const index = parseInt(tekstSelect?.value);
    if (!isNaN(index) && index >= 1 && index <= 10) {
      tekstRef.set({ inhoud: standaardTeksten[index - 1] });
    }
  });

  eigenTekstKnop?.addEventListener("click", () => {
    const input = document.getElementById("customTextInput");
    if (!input) return;
    const tekst = input.value.trim();
    tekstRef.set({ inhoud: tekst });
  });

  verbergTekstKnop?.addEventListener("click", () => {
    tekstRef.set({ inhoud: "" });
  });


  
  tekstRef.on("value", (snapshot) => {
    const tekst = snapshot.val()?.inhoud || "";

    // Alle tekstblokken verbergen
    document.querySelectorAll(".tekst").forEach(el => {
      el.style.display = "none";
      el.textContent = "";
    });

    // Toon juiste blok
    const index = standaardTeksten.indexOf(tekst);
    const id = index >= 0 ? `tekst${index + 1}` : "eigenTekst";
    const target = document.getElementById(id);
    if (target) {
      target.textContent = tekst;
      target.style.display = "block";
    }
  });

// === UI AANPASSINGEN ===
  const controlsDiv = document.querySelector(".controls");
  const tekstControls = document.getElementById("tekstControls");
  const logo = document.getElementById("logo");
  const title = document.getElementById("pageTitle");
  const teamUploadIframeSection = document.getElementById("teamUploadIframeSection");

  if (controlsDiv) controlsDiv.style.display = isDisplayMode ? "none" : "flex";
  if (tekstControls) tekstControls.style.display = isDisplayMode ? "none" : "block";
  if (slider) slider.style.display = isDisplayMode ? "none" : "block";
  if (logo) logo.style.display = isDisplayMode ? "block" : "none";
  if (title) title.style.display = isDisplayMode ? "block" : "none";


  // === JOTFORM IFRAME INVOEGEN PER TEAM ===
  const teamFormUrls = {
    "37xskp": "https://form.jotform.com/250903000714341",
    "z8kd01": "https://form.jotform.com/250901825652052"
  };

  if (isDisplayMode && teamCode && teamFormUrls[teamCode] && teamUploadIframeSection) {
    const iframe = document.createElement("iframe");
    iframe.id = "JotFormIFrame-" + teamCode;
    iframe.title = "Upload hier jullie foto's";
    iframe.allowTransparency = true;
    iframe.allow = "geolocation; microphone; camera; fullscreen";
    iframe.src = teamFormUrls[teamCode] + "?teamnaam=" + encodeURIComponent(allowedTeams[teamCode]);
    iframe.style = "min-width:100%;max-width:100%;height:800px;border:none;border-radius:10px;";
    iframe.scrolling = "no";

    teamUploadIframeSection.appendChild(iframe);
    teamUploadIframeSection.style.display = "block";

    const script = document.createElement("script");
    script.src = "https://cdn.jotfor.ms/s/umd/latest/for-form-embed-handler.js";
    document.body.appendChild(script);
  }


  const refreshBtn = document.getElementById("refreshBtn");
  refreshBtn?.addEventListener("click", () => {
    location.reload();
  });


  
  const standaardTeksten = [
    "Welkom bij KDW 25! Veel plezier en succes vandaag!",
    "De volgende opdracht staat voor jullie klaar. Bekijk de aanwijzing goed.",
    "Let op: je kunt nu bonuspunten verdienen met een goede inschatting.",
    "Halverwege! Tijd voor een korte pauze of wisselmoment.",
    "De tijd tikt door ‚Äì vergeet niet in te leveren voor de deadline.",
    "Jullie hebben nog 30 minuten. Hou het tempo erin!",
    "Laatste 10 minuten ‚Äì nu telt alles!",
    "Verzamel je team en maak je klaar voor het eindspel.",
    "LET OP: Antwoorden worden niet meer geaccepteerd.",
    "Bedankt voor jullie deelname aan KDW 25!"
  ];

window.toonGeselecteerdeTekst = () => {
    const select = document.getElementById("tekstSelect");
    const index = parseInt(select?.value);
    if (!isNaN(index) && index >= 1 && index <= 10) {
      tekstRef.set({ inhoud: standaardTeksten[index - 1] });
    }
  };


  window.toonVrijeTekst = () => {
    const input = document.getElementById("customTextInput");
    if (!input) return;
    const tekst = input.value.trim();
    tekstRef.set({ inhoud: tekst });
  };

  window.verbergTeksten = () => {
    tekstRef.set({ inhoud: "" });
  };

}); // ‚úÖ sluit enige echte DOMContentLoaded
</script>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code Maastricht</title>

    <!-- Thema voor browser en PWA -->
    <meta name="theme-color" content="#000000" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Code Maastricht" />

    <!-- App iconen -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="/icon-192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="/icon-512.png" />
    <link rel="shortcut icon" href="/icon-192.png" type="image/png" />
  </head>

<body>
  <h1 id="pageTitle" style="display: none; font-size: clamp(2.5em, 8vw, 5em); margin-bottom: 0.5em;">Code Maastricht</h1>

  <div id="teamLabel" style="display: none; font-size: 1.5em; color: orange; margin-bottom: 1em;"></div>

  <div id="timer">02:30:00</div>
  <input type="range" id="timeSlider" min="0" max="9000" value="9000" />

  <div class="controls">
    <input type="text" id="manualTimeInput" placeholder="hh:mm:ss" />
    <button onclick="stelHandmatigTijdIn()">Tijd instellen</button>
    <button id="startBtn">Start</button>
    <button id="stopBtn">Stop</button>
    <button id="resetBtn">Reset</button>
  </div>

  <div id="tekstControls" class="tekst-controls">
    <input type="text" id="customTextInput" placeholder="Eigen boodschap..." />
    <button onclick="toonVrijeTekst()">Toon eigen tekst</button>
    <select id="tekstSelect">
      <option value="">-- Kies een tekst --</option>
      <option value="1">1. Welkom bij KDW 25</option>
      <option value="2">2. Volgende opdracht beschikbaar</option>
      <option value="3">3. Kans op bonuspunten</option>
      <option value="4">4. Halverwege moment</option>
      <option value="5">5. Denk aan de deadline</option>
      <option value="6">6. Nog 30 minuten</option>
      <option value="7">7. Laatste 10 minuten</option>
      <option value="8">8. Eindspel voorbereiden</option>
      <option value="9">9. Geen antwoorden meer</option>
      <option value="10">10. Bedankt voor deelname</option>
    </select>
    <button onclick="toonGeselecteerdeTekst()">Toon geselecteerde tekst</button>
    <button onclick="verbergTeksten()">Verberg alles</button><br/>

    <input id="inputTeamA" type="text" placeholder="Naam voor Team A" style="margin-bottom: 0.5em;" /><br/>
    <input id="inputTeamB" type="text" placeholder="Naam voor Team B" style="margin-bottom: 0.5em;" /><br/>
    <button id="opslaanTeamnamen">Teamnamen opslaan</button>
  </div>

  <div id="tekstContainer">
    <div id="tekst1" class="tekst" style="display:none;"></div>
    <div id="tekst2" class="tekst" style="display:none;"></div>
    <div id="tekst3" class="tekst" style="display:none;"></div>
    <div id="tekst4" class="tekst" style="display:none;"></div>
    <div id="tekst5" class="tekst" style="display:none;"></div>
    <div id="tekst6" class="tekst" style="display:none;"></div>
    <div id="tekst7" class="tekst" style="display:none;"></div>
    <div id="tekst8" class="tekst" style="display:none;"></div>
    <div id="tekst9" class="tekst" style="display:none;"></div>
    <div id="tekst10" class="tekst" style="display:none;"></div>
    <div id="eigenTekst" class="tekst" style="display:none;"></div>
  </div>

  <div id="scoreBoard">
    <div id="scoreCardA" class="scorecard">
      <span id="scoreNameA" class="scoreName">Team A</span>
      <div id="scoreValueA">0</div>
    </div>
    <div id="scoreCardB" class="scorecard">
      <span id="scoreNameB" class="scoreName">Team B</span>
      <div id="scoreValueB">0</div>
    </div>
  </div>

  <div id="teamUploadIframeSection" style="width: 100%; max-width: 800px; margin: 2em auto; display: none;"></div>

  <div id="refreshBtnWrapper" style="text-align: center;">
    <button id="refreshBtn">
      üîÑ
    </button>
    <div id="refreshWarning" style="font-size: 0.9em; color: orange; margin-top: 10px; display: none;">
      ‚ö†Ô∏è Deze knop ververst de pagina zodat de uploadfunctie weer zichtbaar wordt!
    </div>
  </div>

  <div id="scoreControls" style="display: none;">
    <button id="scorePlus1">+1</button>
    <button id="scorePlus2">+2</button>
    <button id="scoreMinus1">-1</button>
  </div>

  <!-- Logo -->
  <img id="logo" src="KDW25.png" alt="KDW25 Logo" style="display: none; position: relative; margin: 2em auto 0 auto; height: clamp(150px, 30vw, 280px); opacity: 0.95; pointer-events: none;" />
  
  <!-- Footer -->
  <div class="footer">
    <span>¬© Geerten Liesker</span>
  </div>
</body>
</html>
