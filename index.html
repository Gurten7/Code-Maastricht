<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Code Maastricht</title>

  <!-- Thema voor browser en PWA -->
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Code Maastricht" />

  <!-- App iconen -->
  <link rel="icon" type="image/png" sizes="192x192" href="/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/icon-512.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="/icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="/icon-512.png" />
  <link rel="shortcut icon" href="/icon-192.png" type="image/png" />

  <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@700&display=swap" rel="stylesheet">

 <!-- OneSignal SDK -->
<script defer src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js"></script> 
<script>
  
  // Zorg ervoor dat de array OneSignalDeferred goed is ge√Ønitialiseerd
  window.OneSignalDeferred = window.OneSignalDeferred || [];

  // Voeg de functie toe aan de wachtrij van OneSignalDeferred
  OneSignalDeferred.push(async function(OneSignal) {
    try {
      const urlParams = new URLSearchParams(location.search);
      const view = urlParams.get("view");
      const team = urlParams.get("team");
      const tag = view === "edit123" ? "beheer" : team;

      // Initialiseer OneSignal
      await OneSignal.init({
        appId: "0c55e75a-a7cc-4829-8359-3171d4f456d0",
        language: "nl",
        notifyButton: {
          enable: false // ‚õîÔ∏è belletje uitgezet
        },
        promptOptions: {
          slidedown: {
            enabled: true,
            autoPrompt: true // ‚úÖ automatische prompt weer aan
          }
        }
      });

      // Voeg de tag toe als deze bestaat
      if (tag) {
        await OneSignal.User.addTags({ team: tag });
        console.log("‚úÖ Tag ingesteld:", tag);
      }

      // Verkrijg de permissiestatus voor meldingen
      const status = await OneSignal.Notifications.permission;
      console.log("üîî Permissiestatus:", status);
    } catch (err) {
      console.error("‚ùå Fout bij OneSignal initialisatie:", err);
    }
  });
</script>

  <!-- Firebase (Realtime Database) behouden -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
  
  <style>
 body {
    font-family: Arial, sans-serif;
    background-color: #000;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    margin: 0;
    padding: 1em;
    box-sizing: border-box;
    text-align: center;
  }
  
  max-width: 100%; {
  overflow-x: hidden; /* Voorkomt horizontaal scrollen */
}

 header {
  display: flex;
  align-items: center;  /* Zorgt ervoor dat de tekst en het logo verticaal worden uitgelijnd */
  justify-content: center;  /* Centreert de inhoud horizontaal */
  gap: 10px;  /* Verkleint de ruimte tussen het logo en de tekst */
  padding: 1em 0;  /* Verhoog de padding om ruimte boven en onder te krijgen */
}

#logo {
  max-width: 100px; /* Pas het logo aan zodat het kleiner is */
  height: auto;
  opacity: 0.95;
}

header h1 {
  font-size: 2.5em;
  color: orange;
  margin: 0;
}

  /* Verberg header en nav-balk standaard */
.hide-header-nav {
  display: none;
}

  #teamLabel {
    font-size: 1.5em;
    margin: 0.3em 0 1em;
    color: orange;
    display: none;
  }

  #timer {
    font-size: clamp(3em, 10vw, 6em);
    padding: 0.5em 1em;
    background: #111;
    border: 5px solid white;
    border-radius: 20px;
    text-align: center;
    margin-bottom: 1em;
    width: 80%;
    max-width: 500px;
  }

  .controls {
    margin-top: 1.5em;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
  }

  input[type="text"], select {
    padding: 0.5em;
    font-size: 1em;
    width: 100%;
    max-width: 300px;
    margin: 8px 0;
    box-sizing: border-box;
  }

  #timeSlider {
    width: 100%;
    max-width: 500px;
    margin-top: 1em;
  }

  .flash {
    animation: flash 1s infinite;
  }

  @keyframes flash {
    0%, 100% { background: #111; color: white; }
    50% { background: red; color: black; }
  }

  .urgent {
    animation: urgentFlash 1s infinite;
  }

  @keyframes urgentFlash {
    0%, 100% { background: #111; color: white; }
    50% { background: darkred; color: yellow; transform: scale(1.05); }
  }

  .footer {
    bottom: 1em;
    right: 1em;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0.3em;
    color: gray;
    font-size: 1.0em;
    text-align: right;
    z-index: 9999;
  }

  #scoreBoard {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1em;
    margin: 2em 0;
    width: 100%;
    max-width: 600px;
  }

  .scorecard {
    flex: 1 1 200px;
    max-width: 240px;
    background: #111;
    color: white;
    border: 5px solid white;
    border-radius: 20px;
    font-size: 2em;
    padding: 1em;
    cursor: pointer;
    text-align: center;
  }

  .scorecard .scoreName {
    font-size: 0.7em;
    color: orange;
    display: block;
    margin-bottom: 0.3em;
  }

  .scorecard.selected {
    border-color: orange;
  }

  #scoreControls {
    display: flex;
    justify-content: center;
    gap: 1em;
    flex-wrap: wrap;
    margin-top: 1em;
    width: 100%;
    max-width: 300px;
  }

  #scoreControls .score-btn {
    background: #222;
    color: white;
    border: 2px solid white;
    border-radius: 10px;
    padding: 0.5em;
    font-size: 1em;
    cursor: pointer;
    flex: 1 1 auto;
  }

  #teamUploadIframeSection iframe {
    width: 100%;
    height: 530px; /* iets kleiner zodat de Jotform-footer net afvalt */
    min-height: 400px;
    overflow: hidden;
    border: none;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(255,255,255,0.2);
    margin-bottom: 0;
    padding-bottom: 0;
  }

  #refreshBtn {
    font-size: 1em;
    padding: 0.5em 1em;
    background-color: transparent;
    color: white;
    border: 2px solid white;
    border-radius: 5px;
    cursor: pointer;
    width: 100px; /* pas dit aan om de knop kleiner te maken */
    margin-top: 1em;
    text-align: center;
  }

  #refreshWarning {
    font-size: 0.9em;
    color: orange;
    margin-top: 10px;
    display: none; /* Standaard niet zichtbaar */
    text-align: center;
  }

  #refreshBtnWrapper:hover #refreshWarning {
    display: block; /* Maak de waarschuwing zichtbaar bij hover */
  }

  @media (max-width: 767px) {
    #timer {
      font-size: clamp(2.2em, 8vw, 4em);
      padding: 0.3em 0.5em;
      margin-bottom: 0.5em;
    }
  }

  @media (max-width: 600px) {
    #teamUploadIframeSection iframe {
      height: 550px; /* iets ruimer als nodig */
      margin-bottom: 0;
    }
  }

  .controls, .tekst-controls {
    max-width: 300px;
    width: 100%;
  }

  button, input[type="text"], select {
    font-size: 0.9em;
    padding: 0.5em;
    margin: 4px 0;
    max-width: 95%;
  }

  #timeSlider {
    margin-top: 0.5em;
    height: 20px;
  }

  .scorecard {
    flex: 1 1 45%;
    max-width: 25%;
  }

/* Navigatiebalk */
nav {
  background-color: #FFA500; /* Oranje kleur */
  color: white;
  padding: 1em 0;
  display: flex;
  justify-content: space-evenly; /* Gelijkmatig verdeelde ruimte */
  gap: 0.3em; /* Verklein de ruimte tussen de tabbladen */
  flex-wrap: nowrap; /* Zorg ervoor dat de tabs altijd naast elkaar staan */
  width: 100%; /* Zorgt ervoor dat de balk over de gehele breedte van het scherm komt */
  margin-top: 1em; /* Zorg ervoor dat de balk onder de header komt */
  min-height: 50px;  /* Voeg een minimale hoogte toe */
}

.nav-item {
  padding: 0.5em 0.8em; /* Verklein de ruimte rond de tekst */
  cursor: pointer;
  font-size: 1.1em; /* Verklein de tekstgrootte van de tabbladen */
  font-weight: bold; /* Maak de tekst dikker (stoerder lettertype) */
  text-transform: uppercase; /* Zet de tekst in hoofdletters */
  background-color: #FFA500; /* Oranje achtergrond */
  color: white;
  border: 2px solid transparent;
  border-radius: 10px;
  text-align: center; /* Zet de tekst in het midden */
  white-space: nowrap; /* Voorkomt dat de tekst over meerdere regels breekt */
  text-decoration: none; /* Verwijder de onderstrepingen */
}

.nav-item:hover {
  background-color: #FF8C00; /* Iets donkerder oranje bij hover */
}

.nav-item.selected {
  background-color: #FFA500; /* Oranje blijft geselecteerd */
  border-color: #FFA500; /* Oranje borderkleur */
}

/* Tabblad-inhoud */
.tab-content {
  display: none;
  margin-top: 20px;
  padding: 20px;
  background-color: #222;
  color: white;
  border: 2px solid #444;
  border-radius: 10px;
}

.tab-content.active {
  display: block;
}

/* Responsieve stijlen voor mobiel */
@media (max-width: 767px) {
  .nav-item {
    padding: 0.5em 1em; /* Kleinere tabknoppen voor mobiel */
    font-size: 1em; /* Verklein de tekst voor mobiel */
  }

  /* Zorg ervoor dat de tabs naast elkaar blijven staan op mobiel */
  nav {
    flex-direction: row; /* Zorgt ervoor dat de tabs naast elkaar blijven op mobiel */
    padding: 0.5em;
    gap: 0.00em; /* Verklein de ruimte tussen de tabs op mobiel */
  }
}

#timer {
  font-size: clamp(2.2em, 8vw, 4em);
  padding: 0.3em 0.5em;
  margin-top: 1.5em; /* Vergroot de ruimte tussen de navigatiebalk en de timer */
  margin-bottom: 0.5em;
}

.nav-item {
  padding: 0.8em 1.5em; /* Kleinere tabbladen op mobiel */
  font-size: 1em;
  flex-grow: 0; /* Zorgt ervoor dat de tabbladen niet te veel ruimte innemen */
}

</style>
</head>
<body>
<script>
window.addEventListener("DOMContentLoaded", function() {
  const urlParams = new URLSearchParams(window.location.search);
  const view = urlParams.get("view");
  const team = urlParams.get("team");

  // Definieer isDisplayMode gebaseerd op de URL
  const isDisplayMode = (view === "display" && team && ["37xskp", "z8kd01"].includes(team));
  
  // Verberg of toon de header en nav op basis van de displaymodus
  if (isDisplayMode) {
    document.querySelector('header').classList.remove('hide-header-nav');
    document.querySelector('nav').classList.remove('hide-header-nav');
  } else {
    document.querySelector('header').classList.add('hide-header-nav');
    document.querySelector('nav').classList.add('hide-header-nav');
  }

  // Firebase-configuratie
  const firebaseConfig = {
    apiKey: "AIzaSyA9PTsrTBR7cYf1oAfPtnyF4g9laqkdwng",
    authDomain: "puzzeltocht-maastricht.firebaseapp.com",
    databaseURL: "https://puzzeltocht-maastricht-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "puzzeltocht-maastricht",
    storageBucket: "puzzeltocht-maastricht.appspot.com",
    messagingSenderId: "825884044147",
    appId: "1:825884044147:web:f329c4af2373cbedbcb306"
  };

  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  
  const db = firebase.database();
  const timerRef = db.ref("timer");
  const tekstRef = db.ref("tekst");
  const teamnamenRef = db.ref("teamnamen");
  const scoresRef = db.ref("scores");
    // Synchroniseer de teamnamen met de UI
    const scoreNameA = document.getElementById("scoreNameA");
    const scoreNameB = document.getElementById("scoreNameB");

    teamnamenRef.on("value", (snapshot) => {
      const data = snapshot.val() || {};
      if (scoreNameA) scoreNameA.textContent = data["37xskp"] || "Team A";
      if (scoreNameB) scoreNameB.textContent = data["z8kd01"] || "Team B";
    });

    // Teamnamen opslaan in Firebase
    const opslaanButton = document.getElementById("opslaanTeamnamen");
    if (opslaanButton) {
      opslaanButton.addEventListener("click", () => {
        const teamAName = document.getElementById("inputTeamA").value.trim();
        const teamBName = document.getElementById("inputTeamB").value.trim();

        if (teamAName && teamBName) {
          teamnamenRef.set({ "37xskp": teamAName, "z8kd01": teamBName })
            .then(() => {
              console.log("Teamnamen succesvol bijgewerkt in Firebase");
            })
            .catch((error) => {
              console.error("Fout bij het bijwerken van teamnamen:", error);
            });
        }
      });
    }

  // iOS standalone check (voor installatietip)
  const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
  const isStandalone = window.navigator.standalone === true;

  if (isDisplayMode && isIos && !isStandalone) {
    const installTip = document.createElement("div");
    installTip.innerHTML = `
      üì≤ <strong>Tip voor iPhone-gebruikers</strong><br/>
      Voeg deze pagina toe aan je beginscherm om meldingen te ontvangen.<br/><br/>
      Tik op <span style="font-size: 1.3em;">üîó</span> onderaan en kies <em>‚ÄòZet op beginscherm‚Äô</em>.
    `;
    installTip.style = `
      background: #220;
      color: orange;
      padding: 1em;
      margin: 1em auto;
      border: 1px solid orange;
      border-radius: 10px;
      text-align: center;
      max-width: 500px;
    `;
    document.body.prepend(installTip);
  }

  // Dynamische teamnaamweergave
  const teamLabel = document.getElementById("teamLabel");
  if (isDisplayMode && team && teamLabel) {
    teamnamenRef.child(team).on("value", (snap) => {
      teamLabel.textContent = snap.val() || "Team onbekend";
      teamLabel.style.display = "block";
    });
  }

  // Timer logica (controleer als timer in de displaymodus moet werken)
  const timerDisplay = document.getElementById("timer");
  const slider = document.getElementById("timeSlider");
  const startBtn = document.getElementById("startBtn");
  const stopBtn = document.getElementById("stopBtn");
  const resetBtn = document.getElementById("resetBtn");
  const manualInput = document.getElementById("manualTimeInput");

  let totalSeconds = 9000;
  let remaining = totalSeconds;
  let interval = null;
  let previousRemaining = null;
  let flashTimeout = null;
  let isSliding = false;

  function formatTime(secs) {
    const h = String(Math.floor(secs / 3600)).padStart(2, '0');
    const m = String(Math.floor((secs % 3600) / 60)).padStart(2, '0');
    const s = String(secs % 60).padStart(2, '0');
    return `${h}:${m}:${s}`;
  }

  function updateDisplay() {
    if (timerDisplay && slider) {
      timerDisplay.textContent = remaining > 0 ? formatTime(remaining) : "TIJD OM!";
      slider.value = remaining;

      // Reset visuele effecten
      timerDisplay.classList.remove("flash", "urgent");
      timerDisplay.style.borderColor = "white";
      timerDisplay.style.backgroundColor = "#111";
      timerDisplay.style.color = "white";
      timerDisplay.style.transform = "scale(1)";

      // Mijlpaalkleuren
      if ([7200, 5400, 3600, 1800].includes(remaining)) {
        timerDisplay.classList.add("flash");
        setTimeout(() => timerDisplay.classList.remove("flash"), 10000);
      }

      // Laatste 10 minuten
      if (remaining > 0 && remaining <= 600) {
        const urgencyLevel = 10 - Math.floor(remaining / 60);
        const scale = 1 + urgencyLevel * 0.03;
        const color = `rgb(${100 + urgencyLevel * 15}, 0, 0)`;
        const bgColor = `rgb(${30 + urgencyLevel * 20}, 0, 0)`;
        timerDisplay.classList.add("urgent");
        timerDisplay.style.transform = `scale(${scale})`;
        timerDisplay.style.color = "yellow";
        timerDisplay.style.backgroundColor = bgColor;
        timerDisplay.style.borderColor = color;
      }
    }
  }

  function updateFirebase(running) {
    const data = { remaining, running };
    if (running) {
      data.timestamp = Date.now();
    }
    timerRef.set(data);
  }

  function calcRemaining(rem, timestamp) {
    const passed = Math.floor((Date.now() - timestamp) / 1000);
    return Math.max(0, rem - passed);
  }

  // Event handlers
  startBtn?.addEventListener("click", () => {
    if (remaining > 0) {
      updateFirebase(true); // Timer starten in Firebase
      interval = setInterval(() => {
        if (!isSliding) {
          remaining -= 1;
          updateDisplay();
          updateFirebase(true);
        }

        if (remaining <= 0) {
          clearInterval(interval);
          interval = null;
          updateFirebase(false);
        }
      }, 1000);
    }
  });

  stopBtn?.addEventListener("click", () => {
    clearInterval(interval);
    interval = null;
    updateFirebase(false);
  });

  resetBtn?.addEventListener("click", () => {
    clearInterval(interval);
    interval = null;
    remaining = totalSeconds;
    updateDisplay();
    timerRef.set({ remaining: totalSeconds, running: false });
  });

  slider?.addEventListener("input", () => {
    isSliding = true;
    remaining = parseInt(slider.value);
    updateDisplay();
  });

  slider?.addEventListener("change", () => {
    isSliding = false;
    updateFirebase(!!interval);
  });

  window.stelHandmatigTijdIn = () => {
    if (!manualInput) return;
    const parts = manualInput.value.trim().split(":").map(Number);
    if (parts.length !== 3 || parts.some(isNaN)) {
      alert("Gebruik het formaat hh:mm:ss");
      return;
    }
    const [h, m, s] = parts;
    const nieuweTijd = h * 3600 + m * 60 + s;
    if (nieuweTijd > 9000) {
      alert("Maximale tijd is 2:30:00 (9000 sec)");
      return;
    }
    remaining = nieuweTijd;
    updateDisplay();
    updateFirebase(!!interval);
  };

  // === JOTFORM IFRAME INVOEGEN PER TEAM ===
  const teamFormUrls = {
    "37xskp": "https://form.jotform.com/250903000714341",
    "z8kd01": "https://form.jotform.com/250901825652052"
  };

  const teamUploadIframeSection = document.getElementById("teamUploadIframeSection");
  if (isDisplayMode && team && teamFormUrls[team] && teamUploadIframeSection) {
    const iframe = document.createElement("iframe");
    iframe.id = "JotFormIFrame-" + team;
    iframe.title = "Upload hier jullie foto's";
    iframe.src = teamFormUrls[team] + "?teamnaam=" + encodeURIComponent(team);
    iframe.style = "min-width:100%;max-width:100%;height:800px;border:none;border-radius:10px;";
    iframe.scrolling = "no";
    teamUploadIframeSection.appendChild(iframe);
  }

  const refreshBtn = document.getElementById("refreshBtn");
  refreshBtn?.addEventListener("click", () => {
    location.reload();
  });
});

window.addEventListener("DOMContentLoaded", function () {
  const urlParams = new URLSearchParams(window.location.search);
  const view = urlParams.get("view");
  const team = urlParams.get("team");

  // Definieer isDisplayMode gebaseerd op de URL
  const isDisplayMode = (view === "display" && team && ["37xskp", "z8kd01"].includes(team));
  
  // Verberg of toon de header en nav op basis van de displaymodus
  if (isDisplayMode) {
    document.querySelector('header').classList.remove('hide-header-nav');
    document.querySelector('nav').classList.remove('hide-header-nav');
  } else {
    document.querySelector('header').classList.add('hide-header-nav');
    document.querySelector('nav').classList.add('hide-header-nav');
  }

  // Firebase-configuratie
  const firebaseConfig = {
    apiKey: "AIzaSyA9PTsrTBR7cYf1oAfPtnyF4g9laqkdwng",
    authDomain: "puzzeltocht-maastricht.firebaseapp.com",
    databaseURL: "https://puzzeltocht-maastricht-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "puzzeltocht-maastricht",
    storageBucket: "puzzeltocht-maastricht.appspot.com",
    messagingSenderId: "825884044147",
    appId: "1:825884044147:web:f329c4af2373cbedbcb306"
  };

  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);

  const db = firebase.database();
  const tekstRef = db.ref("tekst");
  const scoresRef = db.ref("scores");

  // === STANDAARD TEKSTEN ===
  const standaardTeksten = [
    "Welkom bij KDW 25! Veel plezier en succes vandaag!",
    "De volgende opdracht staat voor jullie klaar. Bekijk de aanwijzing goed.",
    "Let op: je kunt nu bonuspunten verdienen met een goede inschatting.",
    "Halverwege! Tijd voor een korte pauze of wisselmoment.",
    "De tijd tikt door ‚Äì vergeet niet in te leveren voor de deadline.",
    "Jullie hebben nog 30 minuten. Hou het tempo erin!",
    "Laatste 10 minuten ‚Äì nu telt alles!",
    "Verzamel je team en maak je klaar voor het eindspel.",
    "LET OP: Antwoorden worden niet meer geaccepteerd.",
    "Bedankt voor jullie deelname aan KDW 25!"
  ];

  // Functie om de geselecteerde tekst in te stellen
  window.toonGeselecteerdeTekst = () => {
    const select = document.getElementById("tekstSelect");
    const index = parseInt(select?.value);
    if (!isNaN(index) && index >= 1 && index <= 10) {
      tekstRef.set({ inhoud: standaardTeksten[index - 1] });
    }
  };

  // Functie om vrije tekst in te stellen
  window.toonVrijeTekst = () => {
    const input = document.getElementById("customTextInput");
    if (input) {
      const tekst = input.value.trim();
      tekstRef.set({ inhoud: tekst });
    }
  };

  // Functie om alle teksten te verbergen
  window.verbergTeksten = () => {
    tekstRef.set({ inhoud: "" });
  };

     // === SCOREBORD ===
  const scoreCardA = document.getElementById("scoreCardA");
  const scoreCardB = document.getElementById("scoreCardB");
  const scoreValueA = document.getElementById("scoreValueA");
  const scoreValueB = document.getElementById("scoreValueB");
  const scoreControls = document.getElementById("scoreControls");

  let geselecteerdScoreCard = null;

  // Functie om de score aan te passen
  const wijzigScore = (delta) => {
    if (!geselecteerdScoreCard) return;
    const teamKey = geselecteerdScoreCard === scoreCardA ? "37xskp" : "z8kd01";
    scoresRef.child(teamKey).once("value", (snapshot) => {
      const huidigeScore = snapshot.val() || 0;
      const nieuweScore = huidigeScore + delta;

      // Voorkom dat de score negatief wordt
      if (nieuweScore >= 0) {
        scoresRef.child(teamKey).set(nieuweScore);
      } else {
        console.warn("De score kan niet negatief zijn.");
      }
    });
  };

  if (scoreControls) {
    scoreControls.style.display = "flex";

    // Functie om het geselecteerde scorebord bij te werken
    const updateSelectedCard = (card) => {
      scoreCardA?.classList.remove("selected");
      scoreCardB?.classList.remove("selected");
      geselecteerdScoreCard = card;
      card.classList.add("selected");
    };

    scoreCardA?.addEventListener("click", () => updateSelectedCard(scoreCardA));
    scoreCardB?.addEventListener("click", () => updateSelectedCard(scoreCardB));

    document.getElementById("scorePlus1")?.addEventListener("click", () => wijzigScore(1));
    document.getElementById("scorePlus2")?.addEventListener("click", () => wijzigScore(2));
    document.getElementById("scoreMinus1")?.addEventListener("click", () => wijzigScore(-1));
  }

  // Synchroniseer de scores in de UI met Firebase
  scoresRef.on("value", (snapshot) => {
    const data = snapshot.val() || {};
    if (scoreValueA) scoreValueA.textContent = data["37xskp"] ?? 0;
    if (scoreValueB) scoreValueB.textContent = data["z8kd01"] ?? 0;
  });
  
  // === TABBLAD LOGICA ===
  // Functie om een tabblad te tonen
  const showTab = (tabId) => {
    // Verwijder de "selected" klasse van alle tabbladen
    document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('selected'));

    // Voeg de "selected" klasse toe aan het aangeklikte tabblad
    const activeTab = document.querySelector(`.tab[onclick="showTab('${tabId}')"]`);
    activeTab.classList.add('selected');

    // Verberg alle tabblad-inhoud
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

    // Toon de geselecteerde tabblad-inhoud
    const activeContent = document.getElementById(tabId);
    activeContent.classList.add('active');
  };

  // Zet het eerste tabblad als standaard actief bij laden van de pagina
  showTab('tab1'); // Zet tab1 als standaard actief

  // === HEADER EN NAV-BALK WEERGAVE ===
  const currentUrl = window.location.href;

  // Als de URL niet de editpagina is, toon dan de header en nav-balk
  if (currentUrl.includes('view=display&team=')) {
    document.querySelector('header').classList.remove('hide-header-nav');
    document.querySelector('nav').classList.remove('hide-header-nav');
  } else {
    // Als de pagina de editpagina is, verberg de header en nav-balk
    document.querySelector('header').classList.add('hide-header-nav');
    document.querySelector('nav').classList.add('hide-header-nav');
  }
});
</script>
<body>

  <!-- Header met logo en tekst -->
  <header class="hide-header-nav">
    <img id="logo" src="KDW25.png" alt="KDW25 Logo" />
    <h1>Code Maastricht</h1>
  </header>

  <nav class="hide-header-nav">
    <a href="javascript:void(0);" class="nav-item tab selected" onclick="showTab('tab1')">Uitleg</a>
    <a href="javascript:void(0);" class="nav-item tab" onclick="showTab('tab2')">Hints</a>
    <a href="javascript:void(0);" class="nav-item tab" onclick="showTab('tab3')">Uploaden</a>
  </nav>

  <div id="timer">02:30:00</div>
  <input type="range" id="timeSlider" min="0" max="9000" value="9000" />

  <div class="controls">
    <input type="text" id="manualTimeInput" placeholder="hh:mm:ss" />
    <button onclick="stelHandmatigTijdIn()">Tijd instellen</button>
    <button id="startBtn">Start</button>
    <button id="stopBtn">Stop</button>
    <button id="resetBtn">Reset</button>
  </div>

  <div id="tekstControls" class="tekst-controls">
    <input type="text" id="customTextInput" placeholder="Eigen boodschap..." />
    <button onclick="toonVrijeTekst()">Toon eigen tekst</button>
    <select id="tekstSelect">
      <option value="">-- Kies een tekst --</option>
      <option value="1">1. Welkom bij KDW 25</option>
      <option value="2">2. Volgende opdracht beschikbaar</option>
      <option value="3">3. Kans op bonuspunten</option>
      <option value="4">4. Halverwege moment</option>
      <option value="5">5. Denk aan de deadline</option>
      <option value="6">6. Nog 30 minuten</option>
      <option value="7">7. Laatste 10 minuten</option>
      <option value="8">8. Eindspel voorbereiden</option>
      <option value="9">9. Geen antwoorden meer</option>
      <option value="10">10. Bedankt voor deelname</option>
    </select>
    <button onclick="toonGeselecteerdeTekst()">Toon geselecteerde tekst</button>
    <button onclick="verbergTeksten()">Verberg alles</button><br/>

 <div id="scoreCardA" class="scorecard">
  <span id="scoreNameA" class="scoreName">Team A</span>
  <div id="scoreValueA">0</div>
</div>
<div id="scoreCardB" class="scorecard">
  <span id="scoreNameB" class="scoreName">Team B</span>
  <div id="scoreValueB">0</div>
</div>

  <div id="tekstContainer">
    <div id="tekst1" class="tekst" style="display:none;"></div>
    <div id="tekst2" class="tekst" style="display:none;"></div>
    <div id="tekst3" class="tekst" style="display:none;"></div>
    <div id="tekst4" class="tekst" style="display:none;"></div>
    <div id="tekst5" class="tekst" style="display:none;"></div>
    <div id="tekst6" class="tekst" style="display:none;"></div>
    <div id="tekst7" class="tekst" style="display:none;"></div>
    <div id="tekst8" class="tekst" style="display:none;"></div>
    <div id="tekst9" class="tekst" style="display:none;"></div>
    <div id="tekst10" class="tekst" style="display:none;"></div>
    <div id="eigenTekst" class="tekst" style="display:none;"></div>
  </div>

  <div id="teamUploadIframeSection" style="width: 100%; max-width: 800px; margin: 2em auto; display: none;"></div>

  <div id="refreshBtnWrapper" style="text-align: center;">
    <button id="refreshBtn">üîÑ</button>
    <div id="refreshWarning" style="font-size: 0.9em; color: orange; margin-top: 10px; display: none;">
      ‚ö†Ô∏è Deze knop ververst de pagina zodat de uploadfunctie weer zichtbaar wordt!
    </div>
  </div>

  <div id="scoreControls" style="display: none;">
    <button id="scorePlus1">+1</button>
    <button id="scorePlus2">+2</button>
    <button id="scoreMinus1">-1</button>
  </div>

  <!-- Tabblad-inhoud -->
  <div id="tab1" class="tab-content active">
    <p>Inhoud voor Speluitleg</p>
  </div>
  <div id="tab2" class="tab-content">
    <p>Inhoud voor Hints</p>
  </div>
  <div id="tab3" class="tab-content">
    <p>Inhoud voor Uploaden</p>
  </div>

  <!-- Footer -->
  <div class="footer">
    <span>¬© Geerten Liesker</span>
  </div>
</body>
</html>
